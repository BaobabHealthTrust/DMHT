=> Booting Mongrel
=> Rails 2.3.5 application starting on http://0.0.0.0:3001
=> Call with -d to detach
=> Ctrl-C to shutdown server
  [4;35;1mSQL (42.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PatientsController#mastercard (for 127.0.0.1 at 2011-11-30 15:47:02) [GET]
  Parameters: {"action"=>"mastercard", "patient_id"=>"505", "controller"=>"patients"}
  [4;36;1mUser Columns (51.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (12.7ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (82.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (22.5ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;36;1mPatient Columns (21.7ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (10.2ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mPerson Load (16.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;35;1mEncounterType Columns (24.0ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounterType Load (6.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'DIABETES TEST') LIMIT 1[0m
  [4;35;1mEncounter Columns (17.7ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
  [4;36;1mEncounter Load (10.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_type` = 38) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;35;1mObservation Load (13.5ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3350)) [0m
  [4;36;1mObservation Columns (1.2ms)[0m   [0;1mSHOW FIELDS FROM `obs`[0m
  [4;35;1mObservation Load (16.0ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3351)) [0m
  [4;36;1mObservation Load (10.4ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3352)) [0m
  [4;35;1mObservation Load (1.3ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18150)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44765)) [0m
  [4;35;1mPerson Columns (5.2ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPersonAddress Load (5.1ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 505 AND (person_address.voided = 0)) ORDER BY person_address.preferred ASC LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'Diabetes Test') LIMIT 1[0m
  [4;36;1mConcept Load (24.7ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='CREATININE') LIMIT 1[0m
  [4;35;1mConcept Columns (11.3ms)[0m   [0mSHOW FIELDS FROM `concept`[0m
  [4;36;1mObservation Load (9.5ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 790)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (6.9ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='URINE PROTEIN') LIMIT 1[0m
  [4;36;1mObservation Load (8.7ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 6447)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Columns (23.4ms)[0m   [0mSHOW FIELDS FROM `concept_name`[0m
  [4;36;1mConceptName Load (16.9ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('RIGHT FOOT/LEG','LEFT FOOT/LEG','LEFT HAND/ARM','RIGHT HAND/ARM')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6721,7002,6722,7001))) ORDER BY obs_datetime DESC[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND encounter.encounter_id IN (18150))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Load (11.6ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE VISUAL ACUITY','RIGHT EYE VISUAL ACUITY')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6699,6700))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE FUNDOSCOPY','RIGHT EYE FUNDOSCOPY')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6712,6713))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='UREA') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 857)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='MACROVASCULAR') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 7587)) ORDER BY obs_datetime DESC[0m
Rendering template within layouts/menu
Rendering patients/mastercard
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 790) [0m
  [4;36;1mConcept Load (20.5ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 679) [0m
  [4;36;1mConcept Load (8.0ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6447) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mUserRole Load (0.2ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (40.0ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mConcept Load (0.2ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6721) [0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6721)) LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9728) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6721) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6721)) LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9242) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mConcept Load (12.1ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6724) [0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6724)) LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9249) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6724) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6724)) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mConcept Load (0.2ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6722) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6722)) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9728) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6722) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6722)) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9242) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6724) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6724)) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9249) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6724) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6724)) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mGlobalProperty Load (17.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 1243ms (View: 216, DB: 695) | 200 OK [http://localhost/patients/mastercard?patient_id=505]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing EncountersController#new (for 127.0.0.1 at 2011-11-30 15:47:22) [GET]
  Parameters: {"diabetes_test_type"=>"FOOT CHECK", "action"=>"new", "patient_id"=>"505 ", "encounter_type"=>"diabetes_test", "controller"=>"encounters"}
  [4;36;1mUser Columns (16.0ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (1.1ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.2ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;36;1mPatient Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mEncounterType Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` IN ('initial diabetes complications','complications','diabetes history','diabetes treatments','hospital admissions','general health','hypertension management','past diabetes medical history')) [0m
  [4;36;1mEncounter Load (662.8ms)[0m   [0;1mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (patient_id= 505 AND encounter_type in (31,43,44,45,46,47,48,49))) ORDER BY encounter_datetime DESC[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0)) AND ((encounter.voided = 0) AND ((encounter.patient_id = 505) AND (encounter.voided = 0))) [0m
  [4;36;1mEncounter Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 39) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 39) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 7) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 65) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;36;1mPerson Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mConceptName Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `concept_name`[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HEIGHT (CM)') LIMIT 1[0m
  [4;35;1mObservation Load (4.7ms)[0m   [0mSELECT * FROM `obs` WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (concept_id = 5090)) [0m
  [4;36;1mObservation Columns (1.1ms)[0m   [0;1mSHOW FIELDS FROM `obs`[0m
Rendering template within layouts/application
Rendering encounters/diabetes_test
  [4;35;1mUserRole Load (0.1ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserProperty Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'keyboard' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 1020ms (View: 168, DB: 694) | 200 OK [http://localhost/encounters/new/diabetes_test?patient_id=505%20&diabetes_test_type=FOOT%20CHECK]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing EncountersController#create (for 127.0.0.1 at 2011-11-30 15:47:43) [POST]
  Parameters: {"urea_unit"=>"mg/dl", "diabetes_test_type"=>"FOOT CHECK", "Visual_Acuity_Control"=>"", "next_url"=>"/patients/mastercard/505", "action"=>"create", "diabetes"=>{"test_year"=>"2011", "test_day"=>"10", "test_month"=>"5"}, "encounter_type"=>"diabetes_test", "creatinine_unit"=>"", "controller"=>"encounters", "encounter"=>{"provider_id"=>"8", "encounter_type_name"=>"DIABETES TEST", "patient_id"=>"505", "encounter_datetime"=>"2011-5-10"}, "observations"=>[{"parent_concept_name"=>"RIGHT FOOT/LEG", "patient_id"=>"505", "concept_name"=>"AMPUTATION", "obs_datetime"=>"Wed Nov 30 15:47:23 +0200 2011", "value_coded_or_text"=>"BELOW KNEE"}]}
  [4;36;1mUser Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (1.1ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;36;1mEncounter Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
  [4;35;1mEncounterType Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'DIABETES TEST') LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (33.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mEncounter Create (432.4ms)[0m   [0mINSERT INTO `encounter` (`form_id`, `voided`, `provider_id`, `creator`, `patient_id`, `voided_by`, `encounter_type`, `date_voided`, `void_reason`, `location_id`, `encounter_datetime`, `date_created`) VALUES(NULL, 0, 8, 8, 505, NULL, 38, NULL, NULL, 4, '2011-05-10 00:00:00', '2011-11-30 15:47:44')[0m
  [4;36;1mSQL (101.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mConcept Load (153.8ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='RIGHT FOOT/LEG') LIMIT 1[0m
  [4;36;1mConcept Columns (10.5ms)[0m   [0;1mSHOW FIELDS FROM `concept`[0m
  [4;35;1mObservation Load (75.8ms)[0m   [0mSELECT * FROM `obs` WHERE (concept_id = 6722 AND encounter_id = 44766) LIMIT 1[0m
  [4;36;1mObservation Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `obs`[0m
  [4;35;1mConceptName Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `concept_name`[0m
  [4;36;1mConceptName Load (16.5ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'AMPUTATION') LIMIT 1[0m
  [4;35;1mConceptName Load (18.9ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'BELOW KNEE') LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mObservation Create (519.1ms)[0m   [0mINSERT INTO `obs` (`value_coded`, `voided`, `value_datetime`, `comments`, `order_id`, `value_coded_name_id`, `creator`, `obs_group_id`, `value_drug`, `date_started`, `voided_by`, `value_location`, `accession_number`, `value_boolean`, `date_voided`, `void_reason`, `person_id`, `location_id`, `value_modifier`, `value_text`, `obs_datetime`, `date_stopped`, `concept_id`, `encounter_id`, `value_group_id`, `value_numeric`, `date_created`) VALUES(6728, 0, NULL, NULL, NULL, 9246, 8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 505, 4, NULL, NULL, '2011-05-10 00:00:00', NULL, 6726, 44766, NULL, NULL, '2011-11-30 15:47:44')[0m
  [4;36;1mSQL (49.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mPatient Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
Redirected to http://localhost:3001/patients/mastercard/505
Completed in 1582ms (DB: 1419) | 302 Found [http://localhost/encounters/create/diabetes_test]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PatientsController#mastercard (for 127.0.0.1 at 2011-11-30 15:47:45) [GET]
  Parameters: {"action"=>"mastercard", "id"=>"505", "controller"=>"patients"}
  [4;36;1mUser Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (1.1ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;36;1mPatient Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;35;1mEncounterType Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'DIABETES TEST') LIMIT 1[0m
  [4;35;1mEncounter Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
  [4;36;1mEncounter Load (49.8ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_type` = 38) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;35;1mObservation Load (29.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3350)) [0m
  [4;36;1mObservation Columns (1.3ms)[0m   [0;1mSHOW FIELDS FROM `obs`[0m
  [4;35;1mObservation Load (4.6ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3351)) [0m
  [4;36;1mObservation Load (0.4ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3352)) [0m
  [4;35;1mObservation Load (42.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18150)) [0m
  [4;36;1mObservation Load (0.4ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44765)) [0m
  [4;35;1mObservation Load (0.3ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44766)) [0m
  [4;36;1mPerson Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPersonAddress Load (0.7ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 505 AND (person_address.voided = 0)) ORDER BY person_address.preferred ASC LIMIT 1[0m
  [4;36;1mEncounterType Load (0.2ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'Diabetes Test') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='CREATININE') LIMIT 1[0m
  [4;36;1mConcept Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `concept`[0m
  [4;35;1mObservation Load (10.9ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 790)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='URINE PROTEIN') LIMIT 1[0m
  [4;35;1mObservation Load (25.4ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 6447)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConceptName Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `concept_name`[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('RIGHT FOOT/LEG','LEFT FOOT/LEG','LEFT HAND/ARM','RIGHT HAND/ARM')) [0m
  [4;36;1mEncounter Load (961.8ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6721,7002,6722,7001))) ORDER BY obs_datetime DESC[0m
  [4;35;1mObservation Load (1.3ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND encounter.encounter_id IN (18150))) ORDER BY obs_datetime DESC[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE VISUAL ACUITY','RIGHT EYE VISUAL ACUITY')) [0m
  [4;35;1mEncounter Load (164.8ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6699,6700))) ORDER BY obs_datetime DESC[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE FUNDOSCOPY','RIGHT EYE FUNDOSCOPY')) [0m
  [4;35;1mEncounter Load (13.3ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6712,6713))) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='UREA') LIMIT 1[0m
  [4;35;1mObservation Load (1.1ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 857)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='MACROVASCULAR') LIMIT 1[0m
  [4;35;1mObservation Load (1.0ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 7587)) ORDER BY obs_datetime DESC[0m
Rendering template within layouts/menu
Rendering patients/mastercard
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 790) [0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 679) [0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6447) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mUserRole Load (0.1ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6721) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6721)) LIMIT 1[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9728) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6721) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6721)) LIMIT 1[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9242) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6724) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6724)) LIMIT 1[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9249) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6724) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6724)) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6722) [0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6722)) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9728) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6722) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6722)) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9242) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6724) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6724)) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9249) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6724) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6724)) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 1514ms (View: 26, DB: 1319) | 200 OK [http://localhost/patients/mastercard/505]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PatientsController#mastercard (for 127.0.0.1 at 2011-11-30 15:48:02) [POST]
  Parameters: {"void"=>"true", "x"=>"18", "y"=>"13", "action"=>"mastercard", "id"=>"505", "controller"=>"patients", "encounter_id"=>"18150"}
  [4;36;1mUser Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;36;1mPatient Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mEncounter Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
  [4;35;1mEncounter Load (0.3ms)[0m   [0mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_id` = 18150) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mObservation Load (0.5ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18150)) [0m
  [4;36;1mObservation Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `obs`[0m
  [4;35;1mObservation Update (63.2ms)[0m   [0mUPDATE `obs` SET `voided` = 1, `voided_by` = 8, `date_voided` = '2011-11-30 15:48:02' WHERE `obs_id` = 25942[0m
  [4;36;1mObservation Update (0.4ms)[0m   [0;1mUPDATE `obs` SET `voided` = 1, `voided_by` = 8, `date_voided` = '2011-11-30 15:48:03' WHERE `obs_id` = 25943[0m
  [4;35;1mObservation Update (10.8ms)[0m   [0mUPDATE `obs` SET `voided` = 1, `voided_by` = 8, `date_voided` = '2011-11-30 15:48:03' WHERE `obs_id` = 25944[0m
  [4;36;1mObservation Update (7.0ms)[0m   [0;1mUPDATE `obs` SET `voided` = 1, `voided_by` = 8, `date_voided` = '2011-11-30 15:48:03' WHERE `obs_id` = 25945[0m
  [4;35;1mObservation Update (5.9ms)[0m   [0mUPDATE `obs` SET `voided` = 1, `voided_by` = 8, `date_voided` = '2011-11-30 15:48:03' WHERE `obs_id` = 25946[0m
  [4;36;1mObservation Update (11.5ms)[0m   [0;1mUPDATE `obs` SET `voided` = 1, `voided_by` = 8, `date_voided` = '2011-11-30 15:48:03' WHERE `obs_id` = 25947[0m
  [4;35;1mObservation Update (0.4ms)[0m   [0mUPDATE `obs` SET `voided` = 1, `voided_by` = 8, `date_voided` = '2011-11-30 15:48:03' WHERE `obs_id` = 25948[0m
  [4;36;1mObservation Update (11.2ms)[0m   [0;1mUPDATE `obs` SET `voided` = 1, `voided_by` = 8, `date_voided` = '2011-11-30 15:48:03' WHERE `obs_id` = 25949[0m
  [4;35;1mOrder Load (43.7ms)[0m   [0mSELECT * FROM `orders` WHERE ((orders.encounter_id = 18150)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 1645) [0m
  [4;35;1mEncounter Update (71.0ms)[0m   [0mUPDATE `encounter` SET `voided` = 1, `voided_by` = 8, `date_voided` = '2011-11-30 15:48:03' WHERE `encounter_id` = 18150[0m
  [4;36;1mSQL (59.0ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;36;1mEncounterType Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'DIABETES TEST') LIMIT 1[0m
  [4;36;1mEncounter Load (4.3ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_type` = 38) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;35;1mObservation Load (0.4ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3350)) [0m
  [4;36;1mObservation Load (0.4ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3351)) [0m
  [4;35;1mObservation Load (0.3ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3352)) [0m
  [4;36;1mObservation Load (0.3ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44765)) [0m
  [4;35;1mObservation Load (0.3ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44766)) [0m
  [4;36;1mPerson Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 505 AND (person_address.voided = 0)) ORDER BY person_address.preferred ASC LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'Diabetes Test') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='CREATININE') LIMIT 1[0m
  [4;36;1mConcept Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `concept`[0m
  [4;35;1mObservation Load (1.8ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 790)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='URINE PROTEIN') LIMIT 1[0m
  [4;35;1mObservation Load (1.7ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 6447)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConceptName Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `concept_name`[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('RIGHT FOOT/LEG','LEFT FOOT/LEG','LEFT HAND/ARM','RIGHT HAND/ARM')) [0m
  [4;36;1mEncounter Load (1.0ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6721,7002,6722,7001))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE VISUAL ACUITY','RIGHT EYE VISUAL ACUITY')) [0m
  [4;36;1mEncounter Load (1.0ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6699,6700))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE FUNDOSCOPY','RIGHT EYE FUNDOSCOPY')) [0m
  [4;36;1mEncounter Load (1.0ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6712,6713))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='UREA') LIMIT 1[0m
  [4;36;1mObservation Load (1.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 857)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='MACROVASCULAR') LIMIT 1[0m
  [4;36;1mObservation Load (1.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 7587)) ORDER BY obs_datetime DESC[0m
Rendering template within layouts/menu
Rendering patients/mastercard
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 790) [0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 679) [0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6447) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mGlobalProperty Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 543ms (View: 13, DB: 311) | 200 OK [http://localhost/patients/mastercard/505]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing EncountersController#new (for 127.0.0.1 at 2011-11-30 15:48:05) [GET]
  Parameters: {"diabetes_test_type"=>"FOOT CHECK", "action"=>"new", "patient_id"=>"505 ", "encounter_type"=>"diabetes_test", "controller"=>"encounters"}
  [4;35;1mUser Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (1.1ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;35;1mPatient Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;35;1mEncounterType Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` IN ('initial diabetes complications','complications','diabetes history','diabetes treatments','hospital admissions','general health','hypertension management','past diabetes medical history')) [0m
  [4;35;1mEncounter Load (0.7ms)[0m   [0mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (patient_id= 505 AND encounter_type in (31,43,44,45,46,47,48,49))) ORDER BY encounter_datetime DESC[0m
  [4;36;1mEncounter Load (0.6ms)[0m   [0;1mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0)) AND ((encounter.voided = 0) AND ((encounter.patient_id = 505) AND (encounter.voided = 0))) [0m
  [4;35;1mEncounter Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 39) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 39) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 7) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 65) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;35;1mPerson Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mConceptName Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `concept_name`[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HEIGHT (CM)') LIMIT 1[0m
  [4;36;1mObservation Load (31.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (concept_id = 5090)) [0m
  [4;35;1mObservation Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `obs`[0m
Rendering template within layouts/application
Rendering encounters/diabetes_test
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserProperty Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.1ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'keyboard' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 238ms (View: 97, DB: 43) | 200 OK [http://localhost/encounters/new/diabetes_test?patient_id=505%20&diabetes_test_type=FOOT%20CHECK]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing EncountersController#create (for 127.0.0.1 at 2011-11-30 15:48:15) [POST]
  Parameters: {"urea_unit"=>"mg/dl", "diabetes_test_type"=>"FOOT CHECK", "Visual_Acuity_Control"=>"", "next_url"=>"/patients/mastercard/505", "action"=>"create", "diabetes"=>{"test_year"=>"2010", "test_day"=>"2", "test_month"=>"3"}, "encounter_type"=>"diabetes_test", "creatinine_unit"=>"", "controller"=>"encounters", "encounter"=>{"provider_id"=>"8", "encounter_type_name"=>"DIABETES TEST", "patient_id"=>"505", "encounter_datetime"=>"2010-3-2"}, "observations"=>[{"parent_concept_name"=>"RIGHT FOOT/LEG", "patient_id"=>"505", "concept_name"=>"AMPUTATION", "obs_datetime"=>"Wed Nov 30 15:48:05 +0200 2011", "value_coded_or_text"=>"BELOW KNEE"}]}
  [4;35;1mUser Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (1.2ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;35;1mEncounter Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
  [4;36;1mEncounterType Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'DIABETES TEST') LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mEncounter Create (0.6ms)[0m   [0;1mINSERT INTO `encounter` (`form_id`, `voided`, `provider_id`, `creator`, `patient_id`, `voided_by`, `encounter_type`, `date_voided`, `void_reason`, `location_id`, `encounter_datetime`, `date_created`) VALUES(NULL, 0, 8, 8, 505, NULL, 38, NULL, NULL, 4, '2010-03-02 00:00:00', '2011-11-30 15:48:15')[0m
  [4;35;1mSQL (52.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='RIGHT FOOT/LEG') LIMIT 1[0m
  [4;35;1mConcept Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `concept`[0m
  [4;36;1mObservation Load (0.4ms)[0m   [0;1mSELECT * FROM `obs` WHERE (concept_id = 6722 AND encounter_id = 44767) LIMIT 1[0m
  [4;35;1mObservation Columns (1.1ms)[0m   [0mSHOW FIELDS FROM `obs`[0m
  [4;36;1mConceptName Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `concept_name`[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'AMPUTATION') LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'BELOW KNEE') LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mObservation Create (14.6ms)[0m   [0;1mINSERT INTO `obs` (`value_coded`, `voided`, `value_datetime`, `comments`, `order_id`, `value_coded_name_id`, `creator`, `obs_group_id`, `value_drug`, `date_started`, `voided_by`, `value_location`, `accession_number`, `value_boolean`, `date_voided`, `void_reason`, `person_id`, `location_id`, `value_modifier`, `value_text`, `obs_datetime`, `date_stopped`, `concept_id`, `encounter_id`, `value_group_id`, `value_numeric`, `date_created`) VALUES(6728, 0, NULL, NULL, NULL, 9246, 8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 505, 4, NULL, NULL, '2010-03-02 00:00:00', NULL, 6726, 44767, NULL, NULL, '2011-11-30 15:48:15')[0m
  [4;35;1mSQL (53.2ms)[0m   [0mCOMMIT[0m
  [4;36;1mPatient Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
Redirected to http://localhost:3001/patients/mastercard/505
Completed in 219ms (DB: 130) | 302 Found [http://localhost/encounters/create/diabetes_test]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PatientsController#mastercard (for 127.0.0.1 at 2011-11-30 15:48:16) [GET]
  Parameters: {"action"=>"mastercard", "id"=>"505", "controller"=>"patients"}
  [4;35;1mUser Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;35;1mPatient Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;36;1mEncounterType Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'DIABETES TEST') LIMIT 1[0m
  [4;36;1mEncounter Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
  [4;35;1mEncounter Load (4.4ms)[0m   [0mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_type` = 38) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;36;1mObservation Load (0.5ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3350)) [0m
  [4;35;1mObservation Columns (1.1ms)[0m   [0mSHOW FIELDS FROM `obs`[0m
  [4;36;1mObservation Load (0.4ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3351)) [0m
  [4;35;1mObservation Load (0.4ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3352)) [0m
  [4;36;1mObservation Load (0.4ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44765)) [0m
  [4;35;1mObservation Load (0.4ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44766)) [0m
  [4;36;1mObservation Load (0.4ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44767)) [0m
  [4;35;1mPerson Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPersonAddress Load (0.1ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 505 AND (person_address.voided = 0)) ORDER BY person_address.preferred ASC LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'Diabetes Test') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='CREATININE') LIMIT 1[0m
  [4;35;1mConcept Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `concept`[0m
  [4;36;1mObservation Load (1.9ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 790)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='URINE PROTEIN') LIMIT 1[0m
  [4;36;1mObservation Load (1.8ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 6447)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `concept_name`[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('RIGHT FOOT/LEG','LEFT FOOT/LEG','LEFT HAND/ARM','RIGHT HAND/ARM')) [0m
  [4;35;1mEncounter Load (1.1ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6721,7002,6722,7001))) ORDER BY obs_datetime DESC[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE VISUAL ACUITY','RIGHT EYE VISUAL ACUITY')) [0m
  [4;35;1mEncounter Load (1.2ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6699,6700))) ORDER BY obs_datetime DESC[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE FUNDOSCOPY','RIGHT EYE FUNDOSCOPY')) [0m
  [4;35;1mEncounter Load (1.0ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6712,6713))) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='UREA') LIMIT 1[0m
  [4;35;1mObservation Load (1.1ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 857)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='MACROVASCULAR') LIMIT 1[0m
  [4;35;1mObservation Load (1.0ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 7587)) ORDER BY obs_datetime DESC[0m
Rendering template within layouts/menu
Rendering patients/mastercard
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 790) [0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 679) [0m
  [4;35;1mConcept Load (0.6ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6447) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mUserRole Load (0.1ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mGlobalProperty Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 207ms (View: 14, DB: 28) | 200 OK [http://localhost/patients/mastercard/505]
Exiting
=> Booting Mongrel
=> Rails 2.3.5 application starting on http://0.0.0.0:3001
=> Call with -d to detach
=> Ctrl-C to shutdown server
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2011-11-30 15:50:44) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;36;1mUser Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (1.1ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserRole Load (0.1ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (`person_name`.`voided` = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 78ms (View: 27, DB: 5) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2011-11-30 15:50:45) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('DIABETES INITIAL QUESTIONS','REGISTRATION','VITALS','TREATMENT','LAB RESULTS')) [0m
  [4;36;1mEncounterType Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (3672.9ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5,6,25,32,65)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('DIABETES INITIAL QUESTIONS','REGISTRATION','VITALS','TREATMENT','LAB RESULTS')) [0m
  [4;36;1mEncounter Load (737.5ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5,6,25,32,65)) AND (DATE(encounter_datetime) = DATE(NOW())) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('DIABETES INITIAL QUESTIONS','REGISTRATION','VITALS','TREATMENT','LAB RESULTS')) [0m
  [4;36;1mEncounter Load (97.9ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5,6,25,32,65)) AND (YEAR(encounter_datetime) = YEAR(NOW())) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('DIABETES INITIAL QUESTIONS','REGISTRATION','VITALS','TREATMENT','LAB RESULTS')) [0m
  [4;36;1mEncounter Load (16.9ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5,6,25,32,65)) GROUP BY encounter.encounter_type[0m
Rendering template within layouts/clinic
Rendering people/overview
  [4;35;1mGlobalProperty Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'interface') LIMIT 1[0m
Completed in 4694ms (View: 91, DB: 4558) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing ApplicationController#index (for 127.0.0.1 at 2011-11-30 15:50:50) [GET]

ActionController::RoutingError (No route matches "/javascripts/jquery-1.3.2.min.js" with {:method=>:get}):
  

Rendering rescues/layout (not_found)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#identifiers (for 127.0.0.1 at 2011-11-30 15:51:01) [GET]
  Parameters: {"action"=>"identifiers", "controller"=>"people"}
  [4;35;1mUser Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (1.1ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
Rendering template within layouts/application
Rendering people/identifiers
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mUserProperty Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.1ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'keyboard' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 74ms (View: 42, DB: 5) | 200 OK [http://localhost/people/identifiers]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2011-11-30 15:51:08) [GET]
  Parameters: {"action"=>"search", "controller"=>"people", "identifier"=>"345"}
  [4;35;1mUser Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (1.1ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = '345') [0m
  [4;35;1mPatient Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;36;1mPerson Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
Redirected to http://localhost:3001/encounters/new?patient_id=505
Completed in 69ms (DB: 5) | 302 Found [http://localhost/people/search?identifier=345]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing EncountersController#new (for 127.0.0.1 at 2011-11-30 15:51:09) [GET]
  Parameters: {"action"=>"new", "patient_id"=>"505", "controller"=>"encounters"}
  [4;36;1mUser Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;36;1mPatient Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mEncounterType Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` IN ('initial diabetes complications','complications','diabetes history','diabetes treatments','hospital admissions','general health','hypertension management','past diabetes medical history')) [0m
  [4;36;1mEncounter Load (0.8ms)[0m   [0;1mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (patient_id= 505 AND encounter_type in (31,43,44,45,46,47,48,49))) ORDER BY encounter_datetime DESC[0m
  [4;35;1mEncounter Load (0.7ms)[0m   [0mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0)) AND ((encounter.voided = 0) AND ((encounter.patient_id = 505) AND (encounter.voided = 0))) [0m
  [4;36;1mEncounter Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 39) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 39) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 7) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 65) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;35;1mPerson Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mConceptName Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `concept_name`[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HEIGHT (CM)') LIMIT 1[0m
  [4;36;1mObservation Load (1.9ms)[0m   [0;1mSELECT * FROM `obs` WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (concept_id = 5090)) [0m
  [4;35;1mObservation Columns (1.1ms)[0m   [0mSHOW FIELDS FROM `obs`[0m
  [4;36;1mEncounter Load (0.6ms)[0m   [0;1mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (DATE(encounter_datetime) = '2011-11-30')) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` IN (65,5)) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0)) AND ((encounter.voided = 0) AND ((encounter.patient_id = 505) AND (encounter.voided = 0))) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` IN (6,7,25,38,39,65,32,5)) [0m
Redirected to http://localhost:3001/patients/show/505
Completed in 177ms (DB: 13) | 302 Found [http://localhost/encounters/new?patient_id=505]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PatientsController#show (for 127.0.0.1 at 2011-11-30 15:51:09) [GET]
  Parameters: {"action"=>"show", "id"=>"505", "controller"=>"patients"}
  [4;35;1mUser Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (1.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mPatient Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (DATE(encounter_datetime) = '2011-11-30')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0)) AND ((encounter.voided = 0) AND ((encounter.patient_id = 505) AND (encounter.voided = 0))) [0m
  [4;36;1mEncounter Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
  [4;35;1mEncounterType Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 39) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 39) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 7) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 65) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='NO') LIMIT 1[0m
  [4;35;1mConcept Columns (1.2ms)[0m   [0mSHOW FIELDS FROM `concept`[0m
  [4;36;1mObservation Load (24.0ms)[0m   [0;1mSELECT * FROM `obs` WHERE (person_id= 505 AND obs_datetime < '2011-11-30' AND value_coded != 1066) ORDER BY obs_datetime DESC LIMIT 50[0m
  [4;35;1mObservation Columns (1.1ms)[0m   [0mSHOW FIELDS FROM `obs`[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Urea') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Urine Protein') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 65) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mObservation Load (0.5ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44763)) [0m
  [4;36;1mObservation Load (0.3ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44764)) [0m
  [4;35;1mEncounter Load (0.8ms)[0m   [0mSELECT * FROM `encounter` WHERE (patient_id= 505 AND encounter_datetime < '2011-11-30' ) ORDER BY encounter_datetime DESC LIMIT 50[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'TREATMENT') LIMIT 1[0m
  [4;35;1mOrderType Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `order_type`[0m
  [4;36;1mOrderType Load (0.1ms)[0m   [0;1mSELECT * FROM `order_type` WHERE (`order_type`.`name` = 'DRUG ORDER') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='DIABETES MEDICATION') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='HYPERTENSION') LIMIT 1[0m
  [4;35;1mOrder Load (411.2ms)[0m   [0mSELECT distinct orders.order_id, orders.concept_id,concept_name.name AS drug_name,obs.value_coded AS diagnosis_id,
 MAX(auto_expire_date) AS end_date, MIN(start_date) AS start_date,
 DATEDIFF(MAX(auto_expire_date), MIN(start_date))AS days,
 DATEDIFF(NOW(), MIN(start_date)) days_so_far,
 dose, drug.units, frequency
 FROM obs
 INNER JOIN encounter on encounter.encounter_id = obs.encounter_id
 INNER JOIN orders on orders.encounter_id = encounter.encounter_id
 INNER JOIN concept_name ON concept_name.concept_id = orders.concept_id
 INNER JOIN drug_order ON drug_order.order_id = orders.order_id
 INNER JOIN drug ON drug.drug_id = drug_order.drug_inventory_id
 INNER JOIN concept_name_tag_map on concept_name_tag_map.concept_name_id = concept_name.concept_name_id
 WHERE encounter_type = 25 AND encounter.patient_id = 505
 AND encounter.voided = 0 AND orders.voided = 0
 AND orders.order_type_id = 1 AND obs.value_coded IN (6871, 903)
 AND concept_name_tag_id = 4
 GROUP BY order_id, obs.value_coded
 ORDER BY drug_name, start_date DESC[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='DIABETES MEDICATION') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='HYPERTENSION MEDICATION') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'TREATMENT') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `order_type` WHERE (`order_type`.`name` = 'DRUG ORDER') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='DIABETES MEDICATION') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='HYPERTENSION') LIMIT 1[0m
  [4;36;1mConceptNameTag Columns (30.6ms)[0m   [0;1mSHOW FIELDS FROM `concept_name_tag`[0m
  [4;35;1mConceptNameTag Load (0.1ms)[0m   [0mSELECT * FROM `concept_name_tag` WHERE (`concept_name_tag`.`tag` = 'PREFERRED') LIMIT 1[0m
  [4;36;1mOrder Load (110.2ms)[0m   [0;1mSELECT medication.drug_name AS drug_name,
 medication.days AS days,
 medication.units AS units,
 medication.dose AS formulation,
 SUM(medication.days_so_far) AS total_medication_days,
 MIN(medication.start_date) AS start_date,
 MAX(medication.end_date) AS end_date,
 medication.diagnosis_id AS diagnosis_id,
 DATEDIFF(NOW(), MIN(medication.start_date)) AS duration
 FROM (
 SELECT auto_expire_date AS end_date, concept_name.name AS drug_name,
 DATEDIFF(auto_expire_date, MIN(start_date)) AS days,
 DATEDIFF(NOW(), start_date) days_so_far,start_date AS start_date,
 dose, drug.units, frequency, obs.value_coded AS diagnosis_id,
 orders.concept_id AS concept_id, orders.order_id AS order_id
 FROM obs, encounter, orders, concept_name,drug_order, drug, concept_name_tag_map
 WHERE encounter_type = 25
 AND encounter.patient_id = 505
 AND encounter.voided = 0
 AND orders.voided = 0
 AND orders.order_type_id = 1
 AND obs.value_coded IN (6871, 903, 6872)
 AND concept_name_tag_id = 4
 AND orders.encounter_id = encounter.encounter_id
 AND encounter.encounter_id = obs.encounter_id
 AND concept_name.concept_id = orders.concept_id
 AND drug_order.order_id = orders.order_id
 AND drug.drug_id = drug_order.drug_inventory_id
 AND concept_name_tag_map.concept_name_id = concept_name.concept_name_id
 GROUP BY auto_expire_date, 	concept_name.name, dose, drug.units, frequency,
 obs.value_coded, 	orders.concept_id, orders.order_id, start_date
 ORDER BY drug_name, start_date DESC) AS medication
 WHERE medication.end_date >= NOW()
 GROUP BY drug_name
 ORDER BY drug_name[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='DIABETES DIAGNOSIS DATE') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='SERIOUS CARDIAC PROBLEM') LIMIT 1[0m
  [4;35;1mConcept Load (4.2ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='STROKE') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='HYPERTENSION') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='TUBERCULOSIS') LIMIT 1[0m
  [4;36;1mPatientIdentifierType Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;35;1mPatientIdentifierType Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'ARV Number') LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 4) AND (patient_identifier.patient_id = 505 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'ARV Number') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 4) AND (patient_identifier.patient_id = 505 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE HIV STATUS') LIMIT 1[0m
  [4;35;1mEncounter Load (1.2ms)[0m   [0mSELECT * FROM `encounter` WHERE (encounter.encounter_type = 39) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;36;1mObservation Load (0.4ms)[0m   [0;1mSELECT `obs`.* FROM `obs` WHERE (`obs`.encounter_id IN (18153,18154)) [0m
  [4;35;1mConceptName Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `concept_name`[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HIV STATUS') LIMIT 1[0m
  [4;35;1mObservation Load (2.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18153) AND (obs.concept_id = 3753)) AND ((obs.voided = 0) AND ((obs.encounter_id = 18153))) ORDER BY obs.obs_id DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HIV STATUS') LIMIT 1[0m
  [4;35;1mObservation Load (0.5ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18154) AND (obs.concept_id = 3753)) AND ((obs.voided = 0) AND ((obs.encounter_id = 18154))) ORDER BY obs.obs_id DESC LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9744) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE HIV STATUS') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (encounter.encounter_type = 39) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `obs`.* FROM `obs` WHERE (`obs`.encounter_id IN (18153,18154)) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HIV TEST DATE') LIMIT 1[0m
  [4;35;1mObservation Load (0.5ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18153) AND (obs.concept_id = 1837)) AND ((obs.voided = 0) AND ((obs.encounter_id = 18153))) ORDER BY obs.obs_id DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HIV TEST DATE') LIMIT 1[0m
  [4;35;1mObservation Load (0.4ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18154) AND (obs.concept_id = 1837)) AND ((obs.voided = 0) AND ((obs.encounter_id = 18154))) ORDER BY obs.obs_id DESC LIMIT 1[0m
  [4;36;1mPatientIdentifierType Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 505 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'demographic_server_ips_and_local_port') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'DIABETES TEST') LIMIT 1[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_type` = 38) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3350)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3351)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3352)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44765)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44766)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44767)) [0m
  [4;36;1mPerson Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 505 AND (person_address.voided = 0)) ORDER BY person_address.preferred ASC LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'Diabetes Test') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='CREATININE') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 790)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 790) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 790)) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='URINE PROTEIN') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 6447)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6447) [0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6447)) LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 679) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('RIGHT FOOT/LEG','LEFT FOOT/LEG')) [0m
  [4;35;1mEncounter Load (0.9ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6721,6722))) [0m
  [4;36;1mObservation Load (14.7ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND encounter.encounter_id IN (NULL))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE VISUAL ACUITY','RIGHT EYE VISUAL ACUITY')) [0m
  [4;36;1mEncounter Load (0.9ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6699,6700))) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND encounter.encounter_id IN (NULL))) ORDER BY obs_datetime DESC[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE FUNDOSCOPY','RIGHT EYE FUNDOSCOPY')) [0m
  [4;35;1mEncounter Load (0.9ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6712,6713))) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND encounter.encounter_id IN (NULL))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='UREA') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 857)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='MACROVASCULAR') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 7587)) ORDER BY obs_datetime DESC[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'TREATMENT') LIMIT 1[0m
  [4;36;1mEncounter Load (3.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_type` = 25) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;35;1mObservation Load (0.4ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18143)) [0m
  [4;36;1mObservation Load (0.3ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 24487)) [0m
  [4;35;1mObservation Load (0.3ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 31610)) [0m
  [4;36;1mObservation Load (0.4ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 42221)) [0m
  [4;35;1mEncounter Load (0.6ms)[0m   [0mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE OUTCOME') LIMIT 1[0m
Rendering template within layouts/menu
Rendering patients/show
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;35;1mPersonName Load (0.2ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 505 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 505 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 505 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.6ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 505 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mPersonAttributeType Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `person_attribute_type`[0m
  [4;35;1mPersonAttributeType Load (0.1ms)[0m   [0mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Cell Phone Number') LIMIT 1[0m
  [4;36;1mPersonAttribute Load (0.1ms)[0m   [0;1mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 12 AND person_id = 505) LIMIT 1[0m
  [4;35;1mPersonAttribute Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `person_attribute`[0m
  [4;36;1mPersonAttributeType Load (0.1ms)[0m   [0;1mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Home Phone Number') LIMIT 1[0m
  [4;35;1mPersonAttribute Load (0.1ms)[0m   [0mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 14 AND person_id = 505) LIMIT 1[0m
  [4;36;1mPersonAttributeType Load (0.1ms)[0m   [0;1mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Office Phone Number') LIMIT 1[0m
  [4;35;1mPersonAttribute Load (0.1ms)[0m   [0mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 15 AND person_id = 505) LIMIT 1[0m
  [4;36;1mPatientIdentifierType Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'Diabetes Number') LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (voided = 0 AND identifier_type = 14 AND patient_id = 505) LIMIT 1[0m
Rendered patients/_details (30.9ms)
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 1079ms (View: 64, DB: 633) | 200 OK [http://localhost/patients/show/505]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PatientsController#graph (for 127.0.0.1 at 2011-11-30 15:51:10) [GET]
  Parameters: {"action"=>"graph", "patient_id"=>"505", "controller"=>"patients"}
  [4;36;1mUser Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (1.2ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;36;1mPatient Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (DATE(encounter_datetime) = '2011-11-30')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0)) AND ((encounter.voided = 0) AND ((encounter.patient_id = 505) AND (encounter.voided = 0))) [0m
  [4;36;1mEncounter Columns (18.0ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
  [4;35;1mEncounterType Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 39) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 39) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 7) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 65) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='NO') LIMIT 1[0m
  [4;35;1mConcept Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `concept`[0m
  [4;36;1mObservation Load (0.2ms)[0m   [0;1mSELECT * FROM `obs` WHERE (person_id= 505 AND obs_datetime < '2011-11-30' AND value_coded != 1066) ORDER BY obs_datetime DESC LIMIT 50[0m
  [4;35;1mObservation Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `obs`[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Urea') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Urine Protein') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 65) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44763)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44764)) [0m
  [4;35;1mEncounter Load (0.6ms)[0m   [0mSELECT * FROM `encounter` WHERE (patient_id= 505 AND encounter_datetime < '2011-11-30' ) ORDER BY encounter_datetime DESC LIMIT 50[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'TREATMENT') LIMIT 1[0m
  [4;35;1mOrderType Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `order_type`[0m
  [4;36;1mOrderType Load (0.2ms)[0m   [0;1mSELECT * FROM `order_type` WHERE (`order_type`.`name` = 'DRUG ORDER') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='DIABETES MEDICATION') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='HYPERTENSION') LIMIT 1[0m
  [4;35;1mOrder Load (56.3ms)[0m   [0mSELECT distinct orders.order_id, orders.concept_id,concept_name.name AS drug_name,obs.value_coded AS diagnosis_id,
 MAX(auto_expire_date) AS end_date, MIN(start_date) AS start_date,
 DATEDIFF(MAX(auto_expire_date), MIN(start_date))AS days,
 DATEDIFF(NOW(), MIN(start_date)) days_so_far,
 dose, drug.units, frequency
 FROM obs
 INNER JOIN encounter on encounter.encounter_id = obs.encounter_id
 INNER JOIN orders on orders.encounter_id = encounter.encounter_id
 INNER JOIN concept_name ON concept_name.concept_id = orders.concept_id
 INNER JOIN drug_order ON drug_order.order_id = orders.order_id
 INNER JOIN drug ON drug.drug_id = drug_order.drug_inventory_id
 INNER JOIN concept_name_tag_map on concept_name_tag_map.concept_name_id = concept_name.concept_name_id
 WHERE encounter_type = 25 AND encounter.patient_id = 505
 AND encounter.voided = 0 AND orders.voided = 0
 AND orders.order_type_id = 1 AND obs.value_coded IN (6871, 903)
 AND concept_name_tag_id = 4
 GROUP BY order_id, obs.value_coded
 ORDER BY drug_name, start_date DESC[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='DIABETES MEDICATION') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='HYPERTENSION MEDICATION') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'TREATMENT') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `order_type` WHERE (`order_type`.`name` = 'DRUG ORDER') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='DIABETES MEDICATION') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='HYPERTENSION') LIMIT 1[0m
  [4;36;1mConceptNameTag Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `concept_name_tag`[0m
  [4;35;1mConceptNameTag Load (0.1ms)[0m   [0mSELECT * FROM `concept_name_tag` WHERE (`concept_name_tag`.`tag` = 'PREFERRED') LIMIT 1[0m
  [4;36;1mOrder Load (6.6ms)[0m   [0;1mSELECT medication.drug_name AS drug_name,
 medication.days AS days,
 medication.units AS units,
 medication.dose AS formulation,
 SUM(medication.days_so_far) AS total_medication_days,
 MIN(medication.start_date) AS start_date,
 MAX(medication.end_date) AS end_date,
 medication.diagnosis_id AS diagnosis_id,
 DATEDIFF(NOW(), MIN(medication.start_date)) AS duration
 FROM (
 SELECT auto_expire_date AS end_date, concept_name.name AS drug_name,
 DATEDIFF(auto_expire_date, MIN(start_date)) AS days,
 DATEDIFF(NOW(), start_date) days_so_far,start_date AS start_date,
 dose, drug.units, frequency, obs.value_coded AS diagnosis_id,
 orders.concept_id AS concept_id, orders.order_id AS order_id
 FROM obs, encounter, orders, concept_name,drug_order, drug, concept_name_tag_map
 WHERE encounter_type = 25
 AND encounter.patient_id = 505
 AND encounter.voided = 0
 AND orders.voided = 0
 AND orders.order_type_id = 1
 AND obs.value_coded IN (6871, 903, 6872)
 AND concept_name_tag_id = 4
 AND orders.encounter_id = encounter.encounter_id
 AND encounter.encounter_id = obs.encounter_id
 AND concept_name.concept_id = orders.concept_id
 AND drug_order.order_id = orders.order_id
 AND drug.drug_id = drug_order.drug_inventory_id
 AND concept_name_tag_map.concept_name_id = concept_name.concept_name_id
 GROUP BY auto_expire_date, 	concept_name.name, dose, drug.units, frequency,
 obs.value_coded, 	orders.concept_id, orders.order_id, start_date
 ORDER BY drug_name, start_date DESC) AS medication
 WHERE medication.end_date >= NOW()
 GROUP BY drug_name
 ORDER BY drug_name[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='DIABETES DIAGNOSIS DATE') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='SERIOUS CARDIAC PROBLEM') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='STROKE') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='HYPERTENSION') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='TUBERCULOSIS') LIMIT 1[0m
  [4;36;1mPatientIdentifierType Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;35;1mPatientIdentifierType Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'ARV Number') LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 4) AND (patient_identifier.patient_id = 505 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'ARV Number') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 4) AND (patient_identifier.patient_id = 505 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE HIV STATUS') LIMIT 1[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (encounter.encounter_type = 39) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` WHERE (`obs`.encounter_id IN (18153,18154)) [0m
  [4;35;1mConceptName Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `concept_name`[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HIV STATUS') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18153) AND (obs.concept_id = 3753)) AND ((obs.voided = 0) AND ((obs.encounter_id = 18153))) ORDER BY obs.obs_id DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HIV STATUS') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18154) AND (obs.concept_id = 3753)) AND ((obs.voided = 0) AND ((obs.encounter_id = 18154))) ORDER BY obs.obs_id DESC LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9744) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE HIV STATUS') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (encounter.encounter_type = 39) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `obs`.* FROM `obs` WHERE (`obs`.encounter_id IN (18153,18154)) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HIV TEST DATE') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18153) AND (obs.concept_id = 1837)) AND ((obs.voided = 0) AND ((obs.encounter_id = 18153))) ORDER BY obs.obs_id DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HIV TEST DATE') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18154) AND (obs.concept_id = 1837)) AND ((obs.voided = 0) AND ((obs.encounter_id = 18154))) ORDER BY obs.obs_id DESC LIMIT 1[0m
  [4;36;1mPatientIdentifierType Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 505 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'demographic_server_ips_and_local_port') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'DIABETES TEST') LIMIT 1[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_type` = 38) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3350)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3351)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3352)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44765)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44766)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44767)) [0m
  [4;36;1mPerson Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 505 AND (person_address.voided = 0)) ORDER BY person_address.preferred ASC LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'Diabetes Test') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='CREATININE') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 790)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 790) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 790)) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='URINE PROTEIN') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 6447)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6447) [0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6447)) LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 679) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('RIGHT FOOT/LEG','LEFT FOOT/LEG')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6721,6722))) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND encounter.encounter_id IN (NULL))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE VISUAL ACUITY','RIGHT EYE VISUAL ACUITY')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6699,6700))) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND encounter.encounter_id IN (NULL))) ORDER BY obs_datetime DESC[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE FUNDOSCOPY','RIGHT EYE FUNDOSCOPY')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6712,6713))) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND encounter.encounter_id IN (NULL))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='UREA') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 857)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='MACROVASCULAR') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 7587)) ORDER BY obs_datetime DESC[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'TREATMENT') LIMIT 1[0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_type` = 25) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18143)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 24487)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 31610)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 42221)) [0m
Rendering patients/graph
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'WEIGHT (KG)') LIMIT 1[0m
  [4;35;1mObservation Load (26.2ms)[0m   [0mSELECT * FROM `obs` WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (concept_id = 5089)) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HEIGHT (CM)') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (concept_id = 5090)) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'SYSTOLIC BLOOD PRESSURE') LIMIT 1[0m
  [4;35;1mObservation Load (36.9ms)[0m   [0mSELECT * FROM `obs` WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (concept_id = 5085)) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'DIASTOLIC BLOOD PRESSURE') LIMIT 1[0m
  [4;35;1mObservation Load (5.3ms)[0m   [0mSELECT * FROM `obs` WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (concept_id = 5086)) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'FASTING') LIMIT 1[0m
  [4;35;1mObservation Load (3.7ms)[0m   [0mSELECT * FROM `obs` WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (concept_id = 6379)) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'RANDOM') LIMIT 1[0m
  [4;35;1mObservation Load (1.1ms)[0m   [0mSELECT * FROM `obs` WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (concept_id = 6380)) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HbA1c') LIMIT 1[0m
  [4;35;1mObservation Load (0.9ms)[0m   [0mSELECT * FROM `obs` WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (concept_id = 6422)) [0m
Completed in 465ms (View: 38, DB: 175) | 200 OK [http://localhost/patients/graph?patient_id=505]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PatientsController#current_encounters (for 127.0.0.1 at 2011-11-30 15:51:11) [GET]
  Parameters: {"action"=>"current_encounters", "id"=>"505", "controller"=>"patients"}
  [4;35;1mUser Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (1.2ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mPatient Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (DATE(encounter_datetime) = '2011-11-30')) [0m
  [4;35;1mEncounter Load (0.2ms)[0m   [0mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0)) AND ((encounter.voided = 0) AND ((encounter.patient_id = 505) AND (encounter.voided = 0))) [0m
  [4;36;1mEncounter Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
  [4;35;1mEncounterType Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 39) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 39) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 7) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 65) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='NO') LIMIT 1[0m
  [4;35;1mConcept Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `concept`[0m
  [4;36;1mObservation Load (0.2ms)[0m   [0;1mSELECT * FROM `obs` WHERE (person_id= 505 AND obs_datetime < '2011-11-30' AND value_coded != 1066) ORDER BY obs_datetime DESC LIMIT 50[0m
  [4;35;1mObservation Columns (1.2ms)[0m   [0mSHOW FIELDS FROM `obs`[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Urea') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Urine Protein') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 65) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44763)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44764)) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (patient_id= 505 AND encounter_datetime < '2011-11-30' ) ORDER BY encounter_datetime DESC LIMIT 50[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'TREATMENT') LIMIT 1[0m
  [4;35;1mOrderType Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `order_type`[0m
  [4;36;1mOrderType Load (0.1ms)[0m   [0;1mSELECT * FROM `order_type` WHERE (`order_type`.`name` = 'DRUG ORDER') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='DIABETES MEDICATION') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='HYPERTENSION') LIMIT 1[0m
  [4;35;1mOrder Load (5.0ms)[0m   [0mSELECT distinct orders.order_id, orders.concept_id,concept_name.name AS drug_name,obs.value_coded AS diagnosis_id,
 MAX(auto_expire_date) AS end_date, MIN(start_date) AS start_date,
 DATEDIFF(MAX(auto_expire_date), MIN(start_date))AS days,
 DATEDIFF(NOW(), MIN(start_date)) days_so_far,
 dose, drug.units, frequency
 FROM obs
 INNER JOIN encounter on encounter.encounter_id = obs.encounter_id
 INNER JOIN orders on orders.encounter_id = encounter.encounter_id
 INNER JOIN concept_name ON concept_name.concept_id = orders.concept_id
 INNER JOIN drug_order ON drug_order.order_id = orders.order_id
 INNER JOIN drug ON drug.drug_id = drug_order.drug_inventory_id
 INNER JOIN concept_name_tag_map on concept_name_tag_map.concept_name_id = concept_name.concept_name_id
 WHERE encounter_type = 25 AND encounter.patient_id = 505
 AND encounter.voided = 0 AND orders.voided = 0
 AND orders.order_type_id = 1 AND obs.value_coded IN (6871, 903)
 AND concept_name_tag_id = 4
 GROUP BY order_id, obs.value_coded
 ORDER BY drug_name, start_date DESC[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='DIABETES MEDICATION') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='HYPERTENSION MEDICATION') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'TREATMENT') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `order_type` WHERE (`order_type`.`name` = 'DRUG ORDER') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='DIABETES MEDICATION') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='HYPERTENSION') LIMIT 1[0m
  [4;36;1mConceptNameTag Columns (1.9ms)[0m   [0;1mSHOW FIELDS FROM `concept_name_tag`[0m
  [4;35;1mConceptNameTag Load (0.1ms)[0m   [0mSELECT * FROM `concept_name_tag` WHERE (`concept_name_tag`.`tag` = 'PREFERRED') LIMIT 1[0m
  [4;36;1mOrder Load (6.7ms)[0m   [0;1mSELECT medication.drug_name AS drug_name,
 medication.days AS days,
 medication.units AS units,
 medication.dose AS formulation,
 SUM(medication.days_so_far) AS total_medication_days,
 MIN(medication.start_date) AS start_date,
 MAX(medication.end_date) AS end_date,
 medication.diagnosis_id AS diagnosis_id,
 DATEDIFF(NOW(), MIN(medication.start_date)) AS duration
 FROM (
 SELECT auto_expire_date AS end_date, concept_name.name AS drug_name,
 DATEDIFF(auto_expire_date, MIN(start_date)) AS days,
 DATEDIFF(NOW(), start_date) days_so_far,start_date AS start_date,
 dose, drug.units, frequency, obs.value_coded AS diagnosis_id,
 orders.concept_id AS concept_id, orders.order_id AS order_id
 FROM obs, encounter, orders, concept_name,drug_order, drug, concept_name_tag_map
 WHERE encounter_type = 25
 AND encounter.patient_id = 505
 AND encounter.voided = 0
 AND orders.voided = 0
 AND orders.order_type_id = 1
 AND obs.value_coded IN (6871, 903, 6872)
 AND concept_name_tag_id = 4
 AND orders.encounter_id = encounter.encounter_id
 AND encounter.encounter_id = obs.encounter_id
 AND concept_name.concept_id = orders.concept_id
 AND drug_order.order_id = orders.order_id
 AND drug.drug_id = drug_order.drug_inventory_id
 AND concept_name_tag_map.concept_name_id = concept_name.concept_name_id
 GROUP BY auto_expire_date, 	concept_name.name, dose, drug.units, frequency,
 obs.value_coded, 	orders.concept_id, orders.order_id, start_date
 ORDER BY drug_name, start_date DESC) AS medication
 WHERE medication.end_date >= NOW()
 GROUP BY drug_name
 ORDER BY drug_name[0m
  [4;35;1mConcept Load (0.2ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='DIABETES DIAGNOSIS DATE') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='SERIOUS CARDIAC PROBLEM') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='STROKE') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='HYPERTENSION') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='TUBERCULOSIS') LIMIT 1[0m
  [4;36;1mPatientIdentifierType Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;35;1mPatientIdentifierType Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'ARV Number') LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 4) AND (patient_identifier.patient_id = 505 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'ARV Number') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 4) AND (patient_identifier.patient_id = 505 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE HIV STATUS') LIMIT 1[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (encounter.encounter_type = 39) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` WHERE (`obs`.encounter_id IN (18153,18154)) [0m
  [4;35;1mConceptName Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `concept_name`[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HIV STATUS') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18153) AND (obs.concept_id = 3753)) AND ((obs.voided = 0) AND ((obs.encounter_id = 18153))) ORDER BY obs.obs_id DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HIV STATUS') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18154) AND (obs.concept_id = 3753)) AND ((obs.voided = 0) AND ((obs.encounter_id = 18154))) ORDER BY obs.obs_id DESC LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 9744) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'UPDATE HIV STATUS') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (encounter.encounter_type = 39) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `obs`.* FROM `obs` WHERE (`obs`.encounter_id IN (18153,18154)) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HIV TEST DATE') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18153) AND (obs.concept_id = 1837)) AND ((obs.voided = 0) AND ((obs.encounter_id = 18153))) ORDER BY obs.obs_id DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HIV TEST DATE') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18154) AND (obs.concept_id = 1837)) AND ((obs.voided = 0) AND ((obs.encounter_id = 18154))) ORDER BY obs.obs_id DESC LIMIT 1[0m
  [4;36;1mPatientIdentifierType Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 505 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'demographic_server_ips_and_local_port') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'DIABETES TEST') LIMIT 1[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_type` = 38) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3350)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3351)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3352)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44765)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44766)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44767)) [0m
  [4;36;1mPerson Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 505 AND (person_address.voided = 0)) ORDER BY person_address.preferred ASC LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'Diabetes Test') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='CREATININE') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 790)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 790) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 790)) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='URINE PROTEIN') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 6447)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6447) [0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6447)) LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 679) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('RIGHT FOOT/LEG','LEFT FOOT/LEG')) [0m
  [4;35;1mEncounter Load (0.2ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6721,6722))) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND encounter.encounter_id IN (NULL))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE VISUAL ACUITY','RIGHT EYE VISUAL ACUITY')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6699,6700))) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND encounter.encounter_id IN (NULL))) ORDER BY obs_datetime DESC[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE FUNDOSCOPY','RIGHT EYE FUNDOSCOPY')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6712,6713))) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND encounter.encounter_id IN (NULL))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='UREA') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 857)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='MACROVASCULAR') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 7587)) ORDER BY obs_datetime DESC[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'TREATMENT') LIMIT 1[0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_type` = 25) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 18143)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 24487)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 31610)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 42221)) [0m
Rendering patients/current_encounters
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'interface') LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 10413) [0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 1103) [0m
Completed in 334ms (View: 26, DB: 35) | 200 OK [http://localhost/patients/current_encounters?id=505]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PatientsController#mastercard (for 127.0.0.1 at 2011-11-30 15:51:20) [GET]
  Parameters: {"action"=>"mastercard", "patient_id"=>"505", "controller"=>"patients"}
  [4;35;1mUser Columns (1.1ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (1.1ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;35;1mPatient Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;36;1mEncounterType Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'DIABETES TEST') LIMIT 1[0m
  [4;36;1mEncounter Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_type` = 38) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3350)) [0m
  [4;35;1mObservation Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `obs`[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3351)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3352)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44765)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44766)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44767)) [0m
  [4;35;1mPerson Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPersonAddress Load (0.1ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 505 AND (person_address.voided = 0)) ORDER BY person_address.preferred ASC LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'Diabetes Test') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='CREATININE') LIMIT 1[0m
  [4;35;1mConcept Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `concept`[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 790)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='URINE PROTEIN') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 6447)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `concept_name`[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('RIGHT FOOT/LEG','LEFT FOOT/LEG','LEFT HAND/ARM','RIGHT HAND/ARM')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6721,7002,6722,7001))) ORDER BY obs_datetime DESC[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE VISUAL ACUITY','RIGHT EYE VISUAL ACUITY')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6699,6700))) ORDER BY obs_datetime DESC[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE FUNDOSCOPY','RIGHT EYE FUNDOSCOPY')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6712,6713))) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='UREA') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 857)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='MACROVASCULAR') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 7587)) ORDER BY obs_datetime DESC[0m
Rendering template within layouts/menu
Rendering patients/mastercard
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 790) [0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 679) [0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6447) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mUserRole Load (0.1ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mGlobalProperty Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 224ms (View: 32, DB: 12) | 200 OK [http://localhost/patients/mastercard?patient_id=505]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing EncountersController#new (for 127.0.0.1 at 2011-11-30 15:51:24) [GET]
  Parameters: {"diabetes_test_type"=>"FOOT CHECK", "action"=>"new", "patient_id"=>"505 ", "encounter_type"=>"diabetes_test", "controller"=>"encounters"}
  [4;36;1mUser Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (6.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (1.1ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;36;1mPatient Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mEncounterType Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` IN ('initial diabetes complications','complications','diabetes history','diabetes treatments','hospital admissions','general health','hypertension management','past diabetes medical history')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (patient_id= 505 AND encounter_type in (31,43,44,45,46,47,48,49))) ORDER BY encounter_datetime DESC[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0)) AND ((encounter.voided = 0) AND ((encounter.patient_id = 505) AND (encounter.voided = 0))) [0m
  [4;36;1mEncounter Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 39) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 39) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 6) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 32) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 25) [0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 7) [0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 65) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 5) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`encounter_type_id` = 38) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;35;1mPerson Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mConceptName Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `concept_name`[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'HEIGHT (CM)') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (concept_id = 5090)) [0m
  [4;35;1mObservation Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `obs`[0m
Rendering template within layouts/application
Rendering encounters/diabetes_test
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserProperty Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.1ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'keyboard' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 322ms (View: 155, DB: 17) | 200 OK [http://localhost/encounters/new/diabetes_test?patient_id=505%20&diabetes_test_type=FOOT%20CHECK]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing EncountersController#create (for 127.0.0.1 at 2011-11-30 15:51:53) [POST]
  Parameters: {"urea_unit"=>"mg/dl", "diabetes_test_type"=>"FOOT CHECK", "Visual_Acuity_Control"=>"", "next_url"=>"/patients/mastercard/505", "action"=>"create", "diabetes"=>{"test_year"=>"2011", "test_day"=>"3", "test_month"=>"10"}, "encounter_type"=>"diabetes_test", "creatinine_unit"=>"", "controller"=>"encounters", "encounter"=>{"provider_id"=>"8", "encounter_type_name"=>"DIABETES TEST", "patient_id"=>"505", "encounter_datetime"=>"2011-12--10-3"}, "observations"=>[{"parent_concept_name"=>"LEFT FOOT/LEG", "patient_id"=>"505", "concept_name"=>"PULSES PRESENT", "obs_datetime"=>"Wed Nov 30 15:51:24 +0200 2011", "value_coded_or_text"=>"DORSALIS PEDIS"}, {"parent_concept_name"=>"LEFT FOOT/LEG", "patient_id"=>"505", "concept_name"=>"DORSALIS PEDIS", "value_coded_or_text"=>"YES"}, {"parent_concept_name"=>"RIGHT FOOT/LEG", "patient_id"=>"505", "concept_name"=>"AMPUTATION", "obs_datetime"=>"Wed Nov 30 15:51:24 +0200 2011", "value_coded_or_text"=>"BELOW KNEE"}]}
  [4;35;1mUser Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;35;1mEncounter Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
  [4;36;1mEncounterType Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'DIABETES TEST') LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mEncounter Create (0.4ms)[0m   [0;1mINSERT INTO `encounter` (`form_id`, `voided`, `provider_id`, `creator`, `patient_id`, `voided_by`, `encounter_type`, `date_voided`, `void_reason`, `location_id`, `encounter_datetime`, `date_created`) VALUES(NULL, 0, 8, 8, 505, NULL, 38, NULL, NULL, 4, '2011-11-30 15:51:53', '2011-11-30 15:51:53')[0m
  [4;35;1mSQL (74.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='LEFT FOOT/LEG') LIMIT 1[0m
  [4;35;1mConcept Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `concept`[0m
  [4;36;1mObservation Load (0.5ms)[0m   [0;1mSELECT * FROM `obs` WHERE (concept_id = 6721 AND encounter_id = 44768) LIMIT 1[0m
  [4;35;1mObservation Columns (2.1ms)[0m   [0mSHOW FIELDS FROM `obs`[0m
  [4;36;1mConceptName Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `concept_name`[0m
  [4;35;1mConceptName Load (16.6ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'PULSES PRESENT') LIMIT 1[0m
  [4;36;1mConceptName Load (0.4ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'DORSALIS PEDIS') LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mObservation Create (29.8ms)[0m   [0;1mINSERT INTO `obs` (`value_coded`, `voided`, `value_datetime`, `comments`, `order_id`, `value_coded_name_id`, `creator`, `obs_group_id`, `value_drug`, `date_started`, `voided_by`, `value_location`, `accession_number`, `value_boolean`, `date_voided`, `void_reason`, `person_id`, `location_id`, `value_modifier`, `value_text`, `obs_datetime`, `date_stopped`, `concept_id`, `encounter_id`, `value_group_id`, `value_numeric`, `date_created`) VALUES(6731, 0, NULL, NULL, NULL, 9249, 8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 505, 4, NULL, NULL, '2011-11-30 15:51:53', NULL, 6724, 44768, NULL, NULL, '2011-11-30 15:51:53')[0m
  [4;35;1mSQL (87.2ms)[0m   [0mCOMMIT[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='LEFT FOOT/LEG') LIMIT 1[0m
  [4;35;1mObservation Load (0.4ms)[0m   [0mSELECT * FROM `obs` WHERE (concept_id = 6721 AND encounter_id = 44768) LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'DORSALIS PEDIS') LIMIT 1[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'YES') LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mObservation Create (53.0ms)[0m   [0mINSERT INTO `obs` (`value_coded`, `voided`, `value_datetime`, `comments`, `order_id`, `value_coded_name_id`, `creator`, `obs_group_id`, `value_drug`, `date_started`, `voided_by`, `value_location`, `accession_number`, `value_boolean`, `date_voided`, `void_reason`, `person_id`, `location_id`, `value_modifier`, `value_text`, `obs_datetime`, `date_stopped`, `concept_id`, `encounter_id`, `value_group_id`, `value_numeric`, `date_created`) VALUES(1065, 0, NULL, NULL, NULL, 1102, 8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 505, 4, NULL, NULL, '2011-11-30 15:51:53', NULL, 6731, 44768, NULL, NULL, '2011-11-30 15:51:53')[0m
  [4;36;1mSQL (52.3ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='RIGHT FOOT/LEG') LIMIT 1[0m
  [4;36;1mObservation Load (0.4ms)[0m   [0;1mSELECT * FROM `obs` WHERE (concept_id = 6722 AND encounter_id = 44768) LIMIT 1[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'AMPUTATION') LIMIT 1[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` = 'BELOW KNEE') LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mObservation Create (0.5ms)[0m   [0;1mINSERT INTO `obs` (`value_coded`, `voided`, `value_datetime`, `comments`, `order_id`, `value_coded_name_id`, `creator`, `obs_group_id`, `value_drug`, `date_started`, `voided_by`, `value_location`, `accession_number`, `value_boolean`, `date_voided`, `void_reason`, `person_id`, `location_id`, `value_modifier`, `value_text`, `obs_datetime`, `date_stopped`, `concept_id`, `encounter_id`, `value_group_id`, `value_numeric`, `date_created`) VALUES(6728, 0, NULL, NULL, NULL, 9246, 8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 505, 4, NULL, NULL, '2011-11-30 15:51:53', NULL, 6726, 44768, NULL, NULL, '2011-11-30 15:51:53')[0m
  [4;35;1mSQL (49.0ms)[0m   [0mCOMMIT[0m
  [4;36;1mPatient Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
Redirected to http://localhost:3001/patients/mastercard/505
Completed in 535ms (DB: 374) | 302 Found [http://localhost/encounters/create/diabetes_test]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PatientsController#mastercard (for 127.0.0.1 at 2011-11-30 15:51:53) [GET]
  Parameters: {"action"=>"mastercard", "id"=>"505", "controller"=>"patients"}
  [4;35;1mUser Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (1.1ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;35;1mPatient Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;36;1mEncounterType Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'DIABETES TEST') LIMIT 1[0m
  [4;36;1mEncounter Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
  [4;35;1mEncounter Load (4.3ms)[0m   [0mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_type` = 38) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;36;1mObservation Load (0.4ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3350)) [0m
  [4;35;1mObservation Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `obs`[0m
  [4;36;1mObservation Load (0.4ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3351)) [0m
  [4;35;1mObservation Load (0.3ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3352)) [0m
  [4;36;1mObservation Load (0.4ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44765)) [0m
  [4;35;1mObservation Load (0.3ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44766)) [0m
  [4;36;1mObservation Load (0.3ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44767)) [0m
  [4;35;1mObservation Load (0.3ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44768)) [0m
  [4;36;1mPerson Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 505 AND (person_address.voided = 0)) ORDER BY person_address.preferred ASC LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'Diabetes Test') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='CREATININE') LIMIT 1[0m
  [4;36;1mConcept Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `concept`[0m
  [4;35;1mObservation Load (1.8ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 790)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='URINE PROTEIN') LIMIT 1[0m
  [4;35;1mObservation Load (1.6ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 6447)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConceptName Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `concept_name`[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('RIGHT FOOT/LEG','LEFT FOOT/LEG','LEFT HAND/ARM','RIGHT HAND/ARM')) [0m
  [4;36;1mEncounter Load (1.1ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6721,7002,6722,7001))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE VISUAL ACUITY','RIGHT EYE VISUAL ACUITY')) [0m
  [4;36;1mEncounter Load (0.9ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6699,6700))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE FUNDOSCOPY','RIGHT EYE FUNDOSCOPY')) [0m
  [4;36;1mEncounter Load (0.9ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6712,6713))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='UREA') LIMIT 1[0m
  [4;36;1mObservation Load (1.0ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 857)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='MACROVASCULAR') LIMIT 1[0m
  [4;36;1mObservation Load (1.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 7587)) ORDER BY obs_datetime DESC[0m
Rendering template within layouts/menu
Rendering patients/mastercard
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 790) [0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 679) [0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6447) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mGlobalProperty Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 203ms (View: 14, DB: 27) | 200 OK [http://localhost/patients/mastercard/505]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PatientsController#print_complications (for 127.0.0.1 at 2011-11-30 15:51:57) [GET]
  Parameters: {"action"=>"print_complications", "patient_id"=>"505", "controller"=>"patients"}
  [4;35;1mUser Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;35;1mPatient Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
Rendering template within layouts/application
Rendering print/print
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mUserProperty Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.1ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'keyboard' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 89ms (View: 45, DB: 5) | 200 OK [http://localhost/patients/print_complications?patient_id=505]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PatientsController#complications_label (for 127.0.0.1 at 2011-11-30 15:51:57) [GET]
  Parameters: {"action"=>"complications_label", "patient_id"=>"505", "controller"=>"patients"}
  [4;35;1mUser Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (1.1ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;35;1mPatient Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;35;1mEncounterType Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'DIABETES TEST') LIMIT 1[0m
  [4;35;1mEncounter Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_type` = 38) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3350)) [0m
  [4;36;1mObservation Columns (1.1ms)[0m   [0;1mSHOW FIELDS FROM `obs`[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3351)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3352)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44765)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44766)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44767)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44768)) [0m
  [4;35;1mPerson Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPersonAddress Load (0.1ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 505 AND (person_address.voided = 0)) ORDER BY person_address.preferred ASC LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'Diabetes Test') LIMIT 1[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='CREATININE') LIMIT 1[0m
  [4;35;1mConcept Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `concept`[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 790)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 790) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 790)) LIMIT 1[0m
  [4;35;1mConceptName Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `concept_name`[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='URINE PROTEIN') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 6447)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6447) [0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE ((concept_name.concept_id = 6447)) LIMIT 1[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 679) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('RIGHT FOOT/LEG','LEFT FOOT/LEG')) [0m
  [4;36;1mEncounter Load (0.9ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6721,6722))) [0m
  [4;35;1mObservation Load (0.3ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND encounter.encounter_id IN (NULL))) ORDER BY obs_datetime DESC[0m
  [4;36;1mConceptName Load (0.1ms)[0m   [0;1mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE VISUAL ACUITY','RIGHT EYE VISUAL ACUITY')) [0m
  [4;35;1mEncounter Load (0.8ms)[0m   [0mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6699,6700))) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND encounter.encounter_id IN (NULL))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE FUNDOSCOPY','RIGHT EYE FUNDOSCOPY')) [0m
  [4;36;1mEncounter Load (1.2ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6712,6713))) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND encounter.encounter_id IN (NULL))) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='UREA') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 857)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='MACROVASCULAR') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 7587)) ORDER BY obs_datetime DESC[0m
  [4;36;1mPatientIdentifierType Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;35;1mPatientIdentifierType Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'Diabetes Number') LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (voided = 0 AND identifier_type = 14 AND patient_id = 505) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'Diabetes Number') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (voided = 0 AND identifier_type = 14 AND patient_id = 505) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'Diabetes Number') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (voided = 0 AND identifier_type = 14 AND patient_id = 505) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 505 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 505 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPatientIdentifierType Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 505 AND (patient_identifier.voided = 0)) LIMIT 1[0m
Sending data 5051572.lbl
Completed in 198ms (View: 1, DB: 17) | 200 OK [http://localhost/patients/complications_label/?patient_id=505]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PatientsController#mastercard (for 127.0.0.1 at 2011-11-30 15:52:03) [GET]
  Parameters: {"action"=>"mastercard", "patient_id"=>"505", "controller"=>"patients"}
  [4;35;1mUser Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (1.0ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 4) LIMIT 1[0m
  [4;35;1mPatient Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 505) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 505) LIMIT 1[0m
  [4;36;1mEncounterType Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'DIABETES TEST') LIMIT 1[0m
  [4;36;1mEncounter Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (`encounter`.`encounter_type` = 38) AND ((encounter.patient_id = 505) AND (encounter.voided = 0)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3350)) [0m
  [4;35;1mObservation Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `obs`[0m
  [4;36;1mObservation Load (0.2ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3351)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 3352)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44765)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44766)) [0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44767)) [0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT * FROM `obs` WHERE ((obs.encounter_id = 44768)) [0m
  [4;36;1mPerson Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 505 AND (person_address.voided = 0)) ORDER BY person_address.preferred ASC LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (`encounter_type`.`name` = 'Diabetes Test') LIMIT 1[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='CREATININE') LIMIT 1[0m
  [4;36;1mConcept Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `concept`[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 790)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='URINE PROTEIN') LIMIT 1[0m
  [4;35;1mObservation Load (0.1ms)[0m   [0mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 6447)) ORDER BY obs_datetime DESC[0m
  [4;36;1mConceptName Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `concept_name`[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('RIGHT FOOT/LEG','LEFT FOOT/LEG','LEFT HAND/ARM','RIGHT HAND/ARM')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6721,7002,6722,7001))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE VISUAL ACUITY','RIGHT EYE VISUAL ACUITY')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6699,6700))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`name` IN ('LEFT EYE FUNDOSCOPY','RIGHT EYE FUNDOSCOPY')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT `encounter`.* FROM `encounter` INNER JOIN `obs` ON obs.encounter_id = encounter.encounter_id WHERE ((encounter.patient_id = 505) AND (encounter.voided = 0) AND (concept_id IN (6712,6713))) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='UREA') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 857)) ORDER BY obs_datetime DESC[0m
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='MACROVASCULAR') LIMIT 1[0m
  [4;36;1mObservation Load (0.1ms)[0m   [0;1mSELECT `obs`.* FROM `obs` INNER JOIN `encounter` ON `encounter`.encounter_id = `obs`.encounter_id WHERE (obs.person_id = 505 AND (obs.voided = 0) AND (encounter_type = 38 AND concept_id = 7587)) ORDER BY obs_datetime DESC[0m
Rendering template within layouts/menu
Rendering patients/mastercard
  [4;35;1mConcept Load (0.1ms)[0m   [0mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 790) [0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;35;1mConceptName Load (0.1ms)[0m   [0mSELECT * FROM `concept_name` WHERE (`concept_name`.`concept_name_id` = 679) [0m
  [4;36;1mConcept Load (0.1ms)[0m   [0;1mSELECT * FROM `concept` WHERE (`concept`.`concept_id` = 6447) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT `concept`.* FROM `concept` INNER JOIN concept_name on concept_name.concept_id = concept.concept_id WHERE (concept.retired = 0 AND concept_name.voided = 0 AND concept_name.name ='Creatinine') LIMIT 1[0m
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mGlobalProperty Columns (48.0ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 237ms (View: 17, DB: 59) | 200 OK [http://localhost/patients/mastercard?patient_id=505]
Exiting
